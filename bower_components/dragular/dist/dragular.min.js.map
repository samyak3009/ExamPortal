{"version":3,"sources":["dragular.js"],"names":["root","factory","exports","module","define","amd","a","i","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","dragularDirective","dragularService","angular","directive","dragular","restrict","link","$scope","iElm","iAttrs","tryJson","json","JSON","parse","e","options","$eval","dragularModel","containersModel","scope","dragularNameSpace","nameSpace","split","dragularOnInit","onInit","$inject","shared","classesCache","containersCtx","containers","mirror","source","item","copy","sourceItem","sourceModel","sourceFilteredModel","target","targetCtx","targetModel","lastDropTarget","offsetX","offsetY","moveX","moveY","offsetXr","offsetYb","clientX","clientY","mirrorWidth","mirrorHeight","initialSibling","currentSibling","initialIndex","currentIndex","tempModel","dragOverEvents","lastElementBehindCursor","grabbed","$rootScope","$compile","service","arg0","arg1","processServiceArguments","initialContainers","document","querySelectorAll","arguments","length","_isArray","isElement","o","copyOptions","extendOptions","tmp","extend","defaultOptions","classes","defaultClasses","eventNames","defaultEventNames","processOptionsObject","boundingBox","sanitizeContainers","containersFilteredModel","forEach","cont","len","getContainers","Error","indexOf","push","getContainersModel","fm","getContainersFilteredModel","registerEvents","remove","op","regEvent","_docElm","release","container","grab","name","eventName","_doc","createEvent","initEvent","createEventObject","eventType","whichMouseButton","metaKey","ctrlKey","context","canStart","eventualMovements","type","isInput","focus","preventDefault","startBecauseMouseMoved","drake","dragging","originalEvent","g","ignoreInputTextSelection","getCoord","elementBehindCursor","elementFromPoint","movements","end","start","direction","getParent","parent","parentNode","parentHeight","offsetHeight","parentWidth","offsetWidth","childHeight","clientHeight","childWidth","clientWidth","offset","getOffset","left","top","right","bottom","renderMirrorImage","addClass","transit","style","drag","preventGrabbed","handle","isContainer","invalid","moves","nextEl","element","clone","$emit","dragularcloned","containerIndex","domIndexOf","dragulardrag","manualStart","rect","getBoundingClientRect","cloneNode","width","height","getRectWidth","getRectHeight","mirrorContainer","appendChild","body","unselectable","scrollContainer","drop","ungrab","moved","notify","removeOnSpill","spillOver","spillOut","pageX","pageY","offsetBox","x","y","lockY","lockX","getElementBehindPoint","dropTarget","findDropTarget","changed","fireEvent","dragularenter","dragularleave","copySortSource","removeChild","reference","immediate","getImmediateChild","getReference","revertOnSpill","insertBefore","dragularshadow","accepted","initial","isInitialPlacement","getTargetCtx","_isFunction","accepts","isContainerAccepts","canBeAccepted","rmClass","hide","s","sibling","undefined","outside","el","children","horizontal","inside","resolve","after","point","state","className","isContainerModel","opt","_getContainers","containersType","to2d","cancel","revert","reverts","dragularcancel","cleanup","dragularrelease","afterDrop","dragulardrop","dropIndex","compileItemOnDrop","$applyAsync","content","splice","dropElmModel","dontCopyModel","dragularremove","removeMirrorImage","dragularout","dragulardragend","destroy","removeContainers","addContainers","makeArray","newIndex","index","before","scrollTop","deltaY","stopPropagation","depSanitize","getBool","dragularover","never","getEmptyArray","always","sanitizeContainersModel","evaluated","fn","touch","mouseup","mousedown","mousemove","pointers","microsoft","$el","addEventListener","opConvert","on","off","passive","navigator","pointerEnabled","msPointerEnabled","all","startIndex","Array","prototype","slice","touches","which","buttons","button","getScroll","scrollProp","offsetProp","window","scrollLeft","manually","nextSibling","nodeType","nextElementSibling","obj","HTMLElement","nodeName","lookupClass","cached","lastIndex","RegExp","current","test","replace","trim","getEventHost","targetTouches","changedTouches","coord","host","missMap","tagName","isEditable","contentEditable","child","extra","dispatchEvent","prop","args","apply","documentElement","isArray","isFunction","cleanEnviroment"],"mappings":"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","file":"dragular.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* global angular */\n\t'use strict';\n\tvar dragularDirective = __webpack_require__( 1 );\n\tvar dragularService = __webpack_require__( 2 );\n\n\t/**\n\t * Dragular 4.6.0 by Luckylooke https://github.com/luckylooke/dragular\n\t * Angular version of dragula https://github.com/bevacqua/dragula\n\t */\n\tmodule.exports = 'dragularModule';\n\n\tangular\n\t\t.module( 'dragularModule', [] )\n\t\t.factory( 'dragularService', dragularService )\n\t\t.directive( 'dragular', dragularDirective );\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\n\t/**\n\t * dragular Directive by Luckylooke https://github.com/luckylooke/dragular\n\t * Angular version of dragula https://github.com/bevacqua/dragula\n\t */\n\n\tvar dragular = function ( dragularService ) {\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: function ( $scope, iElm, iAttrs ) {\n\n\t\t\t\tvar options = $scope.$eval( iAttrs.dragular ) || tryJson( iAttrs.dragular ) || {};\n\n\t\t\t\tfunction tryJson( json ) {\n\t\t\t\t\ttry { // I dont like try catch solutions but I havent find sattisfying way of chcecking json validity.\n\t\t\t\t\t\treturn JSON.parse( json );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( iAttrs.dragularModel ) {\n\t\t\t\t\toptions.containersModel = iAttrs.dragularModel;\n\t\t\t\t\tif ( !options.scope ){\n\t\t\t\t\t\toptions.scope = $scope;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( iAttrs.dragularNameSpace ) {\n\t\t\t\t\toptions.nameSpace = iAttrs.dragularNameSpace.split( ' ' );\n\t\t\t\t}\n\n\t\t\t\tif ( iAttrs.dragularOnInit ) {\n\t\t\t\t\toptions.onInit = $scope.$eval( iAttrs.dragularOnInit );\n\t\t\t\t}\n\n\t\t\t\tdragularService( iElm[ 0 ], options );\n\t\t\t}\n\t\t};\n\t};\n\n\tdragular.$inject = [ 'dragularService' ];\n\n\tmodule.exports = dragular;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\t/* global angular */\n\t'use strict';\n\n\t/**\n\t * dragular Service by Luckylooke https://github.com/luckylooke/dragular\n\t * Angular version of dragula https://github.com/bevacqua/dragula\n\t */\n\n\tvar shared = { // sahred object between all service instances\n\t\tclassesCache: {}, // classes lookup cache\n\t\tcontainersCtx: {}, // containers model\n\t\tcontainers: {}, // containers\n\t\tmirror: null, // mirror image\n\t\tsource: null, // source container\n\t\titem: null, // item being dragged\n\t\tcopy: null, // copy flag\n\t\tsourceItem: null, // item originaly dragged if copy is enabled\n\t\tsourceModel: null, // source container model\n\t\tsourceFilteredModel: null, // source container filtered model if relevant\n\t\ttarget: null, // droppable container under drag item\n\t\ttargetCtx: null, // target container context\n\t\ttargetModel: null, // target container model\n\t\tlastDropTarget: null, // last container item was over\n\t\toffsetX: null, // reference x\n\t\toffsetY: null, // reference y\n\t\tmoveX: null, // reference move x\n\t\tmoveY: null, // reference move y\n\t\toffsetXr: null, // reference x right for boundingBox feature\n\t\toffsetYb: null, // reference y bottom for boundingBox feature\n\t\tclientX: null, // cache client x, init at grab, update at drag\n\t\tclientY: null, // cache client y, init at grab, update at drag\n\t\tmirrorWidth: null, // mirror width for boundingBox feature\n\t\tmirrorHeight: null, // mirror height for boundingBox feature\n\t\tinitialSibling: null, // reference sibling when grabbed\n\t\tcurrentSibling: null, // reference sibling now\n\t\tinitialIndex: null, // reference model index when grabbed\n\t\tcurrentIndex: null, // reference model index now\n\t\ttempModel: null, // if o.isContainer is used, model can be provided as well, it is temporary saved here during drags\n\t\tdragOverEvents: {}, // drag over events fired on element behind cursor\n\t\tlastElementBehindCursor: null, // last element behind cursor\n\t\tgrabbed: null // holds mousedown context until first mousemove\n\t};\n\n\tvar dragularService = function ( $rootScope, $compile ) {\n\n\t\t// abbreviations\n\t\tvar _doc = document,\n\t\t\t_docElm = _doc.documentElement,\n\t\t\t_isArray = Array.isArray,\n\t\t\t_isFunction = angular.isFunction;\n\n\t\t// clean common/shared objects\n\t\tservice.cleanEnviroment = function cleanEnviroment() {\n\t\t\tshared.classesCache = {};\n\t\t\tshared.containersCtx = {};\n\t\t\tshared.containers = {};\n\t\t\tshared.mirror = undefined;\n\t\t};\n\n\t\tservice.shared = shared;\n\n\t\treturn service;\n\n\t\t// service definition\n\t\tfunction service( arg0, arg1 ) {\n\n\t\t\tvar initialContainers = arg0 || [],\n\t\t\t\toptions = arg1 || {},\n\t\t\t\to, // shorthand for options\n\t\t\t\tg = getBool, // shorthand for getBool\n\n\t\t\t\t// defaults\n\t\t\t\tdefaultClasses = {\n\t\t\t\t\tmirror: 'gu-mirror',\n\t\t\t\t\thide: 'gu-hide',\n\t\t\t\t\tunselectable: 'gu-unselectable',\n\t\t\t\t\ttransit: 'gu-transit'\n\t\t\t\t},\n\t\t\t\tdefaultEventNames = {\n\t\t\t\t\t// drag-over DOM events\n\t\t\t\t\tdragularenter: 'dragularenter',\n\t\t\t\t\tdragularleave: 'dragularleave',\n\t\t\t\t\tdragularrelease: 'dragularrelease',\n\t\t\t\t\t// $scope events\n\t\t\t\t\tdragularcloned: 'dragularcloned',\n\t\t\t\t\tdragulardrag: 'dragulardrag',\n\t\t\t\t\tdragularcancel: 'dragularcancel',\n\t\t\t\t\tdragulardrop: 'dragulardrop',\n\t\t\t\t\tdragularremove: 'dragularremove',\n\t\t\t\t\tdragulardragend: 'dragulardragend',\n\t\t\t\t\tdragularshadow: 'dragularshadow',\n\t\t\t\t\tdragularover: 'dragularover',\n\t\t\t\t\tdragularout: 'dragularout'\n\t\t\t\t},\n\t\t\t\tdefaultOptions = { // options with defaults\n\t\t\t\t\tcopyOptions: false, // copy options object when provided\n\t\t\t\t\tclasses: defaultClasses, // classes used by dragular\n\t\t\t\t\teventNames: defaultEventNames, // event names used by dragular\n\t\t\t\t\tcontainers: false, // initial containers provided via options object (are provided via parameter by default)\n\t\t\t\t\tcontainersModel: false, // if provided, model will be synced with DOM\n\t\t\t\t\tcontainersFilteredModel: false, // if provided, dragular will handle filtered model cases\n\t\t\t\t\tisContainer: never, // potential target can be forced to be container by custom logic\n\t\t\t\t\tisContainerModel: getEmptyArray, // if isContainer function is provided, you can provide also respective model\n\t\t\t\t\tisContainerAccepts: always, // if isContainer function is provided, you can provide also respective accept function\n\t\t\t\t\tmoves: always, // can drag start?\n\t\t\t\t\taccepts: always, // can target accept dragged item? (target context used)\n\t\t\t\t\tcanBeAccepted: always, // can be dragged item accepted by target? (source context used)\n\t\t\t\t\tcopy: false, // dragged item will be copy of source? flag or function\n\t\t\t\t\tcopySortSource: false, // enable sorting in source when copying item\n\t\t\t\t\tdontCopyModel: false, // dont make copy of model when coping item (#61)\n\t\t\t\t\tinvalid: never, // target (in)validity function\n\t\t\t\t\trevertOnSpill: false, // item returns to original place\n\t\t\t\t\tremoveOnSpill: false, // item will be removed if not placed into valid target\n\t\t\t\t\tlockX: false, // lock movement into x-axis\n\t\t\t\t\tlockY: false, // lock movement into y-axis\n\t\t\t\t\tboundingBox: false, // lock movement inside this element boundaries\n\t\t\t\t\tmirrorContainer: _doc.body, // element for appending mirror\n\t\t\t\t\tignoreInputTextSelection: true, // text selection in inputs wont be considered as drag\n\t\t\t\t\tcompileItemOnDrop: false,\n\t\t\t\t\tonInit: false // function callback called after dragular initialisation and providing drake as first argument\n\t\t\t\t},\n\n\t\t\t\tdrake = {\n\t\t\t\t\tcontainers: shared.containers, // all containers\n\t\t\t\t\tcontainersCtx: shared.containersCtx, // all contexts to containers\n\t\t\t\t\tsanitizeContainersModel: depSanitize,\n\t\t\t\t\tsanitizeContainers: sanitizeContainers,\n\t\t\t\t\taddContainers: addContainers,\n\t\t\t\t\tremoveContainers: removeContainers,\n\t\t\t\t\tisContainer: isContainer,\n\t\t\t\t\tstart: manualStart,\n\t\t\t\t\tend: end,\n\t\t\t\t\tcancel: cancel,\n\t\t\t\t\tremove: remove,\n\t\t\t\t\tdestroy: destroy,\n\t\t\t\t\tdragging: false\n\t\t\t\t};\n\n\t\t\tprocessServiceArguments(); // both arguments (containers and options) are optional, this function handle this\n\t\t\textendOptions();\n\t\t\tprocessOptionsObject();\n\t\t\tregisterEvents();\n\n\t\t\tif ( o.onInit ) {\n\t\t\t\to.onInit( drake, o );\n\t\t\t}\n\t\t\treturn drake;\n\n\n\t\t\t// Function definitions: ==============================================================================================================\n\n\n\t\t\t// ====================================================================================================================================\n\t\t\t// Dragular service init functions: ---------------------------------------------------------------------------------------------------\n\t\t\t// ====================================================================================================================================\n\n\n\t\t\tfunction processServiceArguments() {\n\n\t\t\t\tif ( typeof arg0 === 'string' ) {\n\t\t\t\t\tinitialContainers = document.querySelectorAll( arg0 );\n\t\t\t\t}\n\t\t\t\telse if (\n\t        arguments.length === 1 && // if there is only one argument we need to distinguish if it is options object or container(s) reference\n\t\t\t\t\t!_isArray( arg0 ) && // array of containers elements\n\t\t\t\t\t!angular.isElement( arg0 ) && // one container element\n\t\t\t\t\t!arg0[ 0 ]){ // array-like object with containers elements\n\t\t\t\t\t// then arg0 is options object\n\t\t\t\t\toptions = arg0 || {};\n\t\t\t\t\tinitialContainers = []; // containers are not provided on init\n\t\t\t\t}\n\n\t\t\t\to = options.copyOptions ? angular.copy( options ) : options;\n\t\t\t}\n\n\t\t\tfunction extendOptions() {\n\n\t\t\t\tvar tmp = angular.extend( {}, defaultOptions, o ); // tmp for keeping defaults untouched\n\t\t\t\tangular.extend( o, tmp ); // merge defaults back into options\n\n\t\t\t\tif ( o.classes ) {\n\n\t\t\t\t\ttmp = angular.extend( {}, defaultClasses, o.classes );\n\t\t\t\t\tangular.extend( o.classes, tmp );\n\t\t\t\t}\n\n\t\t\t\tif ( o.eventNames ) {\n\n\t\t\t\t\ttmp = angular.extend( {}, defaultEventNames, o.eventNames );\n\t\t\t\t\tangular.extend( o.eventNames, tmp );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction processOptionsObject() {\n\n\t\t\t\t// bounding box must be pure DOM element, not jQuery wrapper or something else..\n\t\t\t\tif ( !isElement( o.boundingBox ) ) {\n\t\t\t\t\to.boundingBox = false;\n\t\t\t\t}\n\n\t\t\t\t// initial containers provided via options are higher priority then by parameter\n\t\t\t\tif ( o.containers ) {\n\t\t\t\t\tinitialContainers = o.containers;\n\t\t\t\t}\n\n\t\t\t\t// sanitize initialContainers\n\t\t\t\to.containers = sanitizeContainers( initialContainers, false, o.scope );\n\n\t\t\t\t// sanitize o.containersModel\n\t\t\t\to.containersModel = sanitizeContainers( o.containersModel, true, o.scope );\n\n\t\t\t\t// sanitize o.containersFilteredModel\n\t\t\t\tif ( _isArray( o.containersFilteredModel ) ) {\n\t\t\t\t\t//                  |-------- is 2D array? -----------|\n\t\t\t\t\to.containersFilteredModel = _isArray( o.containersFilteredModel[ 0 ] ) ? o.containersFilteredModel : [ o.containersFilteredModel ];\n\t\t\t\t} else {\n\t\t\t\t\to.containersFilteredModel = [];\n\t\t\t\t}\n\n\t\t\t\t// feed containers groups and optionaly do same for models\n\t\t\t\tif ( !o.nameSpace ) {\n\t\t\t\t\to.nameSpace = [ 'dragularCommon' ];\n\t\t\t\t}\n\n\t\t\t\tif ( !_isArray( o.nameSpace ) ) {\n\t\t\t\t\to.nameSpace = [ o.nameSpace ];\n\t\t\t\t}\n\n\t\t\t\to.nameSpace.forEach( function eachNameSpace( nameSpace ) {\n\n\t\t\t\t\tif ( !shared.containers[ nameSpace ] ) {\n\n\t\t\t\t\t\tshared.containers[ nameSpace ] = [];\n\t\t\t\t\t\tshared.containersCtx[ nameSpace ] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar len = getContainers( o ).length,\n\t\t\t\t\t\tcont;\n\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\n\t\t\t\t\t\tcont = getContainers( o )[ i ];\n\n\t\t\t\t\t\tif (!cont) {\n\t\t\t\t\t\t\tthrow new Error( 'Container element must be defined!' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (shared.containers[ nameSpace ].indexOf(cont) !== -1) {\n\t\t\t\t\t\t\tthrow new Error( 'Cannot register container element more than once! Container element: ' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tshared.containers[ nameSpace ].push(cont);\n\t\t\t\t\t\tshared.containersCtx[ nameSpace ].push({\n\t\t\t\t\t\t\to: o,\n\t\t\t\t\t\t\tm: getContainersModel( o )[ i ], // can be undefined\n\t\t\t\t\t\t\tfm: getContainersFilteredModel( o )[ i ] // can be undefined\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tfunction registerEvents( remove ) {\n\t\t\t\tvar op = remove ? 'off' : 'on';\n\t\t\t\tregEvent( _docElm, op, 'mouseup', release );\n\n\t\t\t\tgetContainers( o ).forEach( function addMouseDown( container ) {\n\t\t\t\t\tregEvent( container, 'on', 'mousedown', grab );\n\t\t\t\t} );\n\n\t\t\t\tif ( !remove ) { // create dragular DOM events\n\t\t\t\t\tangular.forEach( [ 'dragularenter', 'dragularleave', 'dragularrelease' ], function prepareDragOverEvents( name ) {\n\t\t\t\t\t\tvar eventName = o.eventNames[ name ];\n\t\t\t\t\t\tif ( !shared.dragOverEvents[ eventName ] ) {\n\t\t\t\t\t\t\tif ( _doc.createEvent ) {\n\t\t\t\t\t\t\t\tshared.dragOverEvents[ eventName ] = _doc.createEvent( 'HTMLEvents' );\n\t\t\t\t\t\t\t\tshared.dragOverEvents[ eventName ].initEvent( eventName, true, true );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshared.dragOverEvents[ eventName ] = _doc.createEventObject();\n\t\t\t\t\t\t\t\tshared.dragOverEvents[ eventName ].eventType = eventName;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// ====================================================================================================================================\n\t\t\t// Grab stage: ------------------------------------------------------------------------------------------------------------------------\n\t\t\t// ====================================================================================================================================\n\n\n\t\t\tfunction grab( e ) {\n\n\t\t\t\t// filter some odd situations\n\t\t\t\tif ( whichMouseButton( e ) !== 1 || e.metaKey || e.ctrlKey ) {\n\t\t\t\t\treturn; // we only care about honest-to-god left clicks and touch events\n\t\t\t\t}\n\n\t\t\t\t// set itial values\n\t\t\t\tshared.moveX = e.clientX;\n\t\t\t\tshared.moveY = e.clientY;\n\n\t\t\t\tvar context = canStart( e.target );\n\t\t\t\tif ( !context || !context.item ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tshared.grabbed = context;\n\t\t\t\teventualMovements();\n\t\t\t\tif ( e.type === 'mousedown' ) {\n\t\t\t\t\tif ( isInput( e.target ) ) { // see also: https://github.com/bevacqua/dragula/issues/208\n\t\t\t\t\t\te.target.focus(); // fixes https://github.com/bevacqua/dragula/issues/176\n\t\t\t\t\t\t// changed from context.item to e.target fixing https://github.com/luckylooke/dragular/issues/87#issuecomment-256865796\n\t\t\t\t\t} else {\n\t\t\t\t\t\te.preventDefault(); // fixes https://github.com/bevacqua/dragula/issues/155\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction eventualMovements( remove ) {\n\n\t\t\t\tvar op = remove ? 'off' : 'on';\n\t\t\t\tregEvent( _docElm, op, 'mousemove', startBecauseMouseMoved );\n\t\t\t}\n\n\t\t\tfunction startBecauseMouseMoved( e ) {\n\n\t\t\t\tif ( !shared.grabbed || drake.dragging ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( e.originalEvent ) {\n\t\t\t\t\te = e.originalEvent; // jQuery enviroment\n\t\t\t\t}\n\n\t\t\t\tif ( whichMouseButton( e ) === 0 ) {\n\t\t\t\t\trelease( {} );\n\t\t\t\t\treturn; // when text is selected on an input and then dragged, mouseup doesn't fire. this is our only hope\n\t\t\t\t}\n\n\t\t\t\t// truthy check fixes dragula-#239, equality fixes dragula-#207\n\t\t\t\tif ( e.clientX && e.clientX === shared.moveX && e.clientY && e.clientY === shared.moveY ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( g( o.ignoreInputTextSelection ) ) {\n\n\t\t\t\t\tvar clientX = getCoord( 'clientX', e ),\n\t\t\t\t\t\tclientY = getCoord( 'clientY', e ),\n\t\t\t\t\t\telementBehindCursor = _doc.elementFromPoint( clientX, clientY );\n\t\t\t\t\tif ( isInput( elementBehindCursor ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar grabbed = shared.grabbed; // calling end() unsets shared.grabbed\n\t\t\t\teventualMovements( 'remove' ); // remove mousemove listener\n\t\t\t\tmovements();\n\t\t\t\tend();\n\t\t\t\tstart( grabbed );\n\n\t\t\t\tif ( !shared.item ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// automaticly detect direction of elements if not set in options\n\t\t\t\tif ( !o.direction && getParent( shared.sourceItem ) ) {\n\t\t\t\t\tvar parent = shared.sourceItem.parentNode,\n\t\t\t\t\t\tparentHeight = parent.offsetHeight,\n\t\t\t\t\t\tparentWidth = parent.offsetWidth,\n\t\t\t\t\t\tchildHeight = shared.sourceItem.clientHeight,\n\t\t\t\t\t\tchildWidth = shared.sourceItem.clientWidth;\n\t\t\t\t\to.direction = parentHeight / childHeight < parentWidth / childWidth ? 'horizontal' : 'vertical';\n\t\t\t\t}\n\n\t\t\t\t// get initial coordinates, used to render shared.mirror for first time\n\t\t\t\tvar offset = getOffset( shared.sourceItem );\n\t\t\t\tshared.offsetX = getCoord( 'pageX', e ) - offset.left;\n\t\t\t\tshared.offsetY = getCoord( 'pageY', e ) - offset.top;\n\t\t\t\tshared.clientX = getCoord( 'clientX', e );\n\t\t\t\tshared.clientY = getCoord( 'clientY', e );\n\n\t\t\t\t// limiting area of shared.mirror movement, get initial coordinates\n\t\t\t\tif ( o.boundingBox ) {\n\t\t\t\t\tshared.offsetXr = getCoord( 'pageX', e ) - offset.right;\n\t\t\t\t\tshared.offsetYb = getCoord( 'pageY', e ) - offset.bottom;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\trenderMirrorImage();\n\t\t\t\taddClass( shared.item, o.classes.transit );\n\t\t\t\t// initial position\n\t\t\t\tshared.mirror.style.left = shared.clientX - shared.offsetX + 'px';\n\t\t\t\tshared.mirror.style.top = shared.clientY - shared.offsetY + 'px';\n\n\t\t\t\tdrag( e );\n\t\t\t}\n\n\t\t\tfunction movements( remove ) {\n\n\t\t\t\tvar op = remove ? 'off' : 'on';\n\t\t\t\tregEvent( _docElm, op, 'selectstart', preventGrabbed ); // IE8\n\t\t\t\tregEvent( _docElm, op, 'click', preventGrabbed );\n\t\t\t\tregEvent( _docElm, op, 'touchmove', preventGrabbed ); // fixes touch devices scrolling while drag\n\t\t\t}\n\n\t\t\tfunction canStart( item ) {\n\t\t\t\tif ( drake.dragging && shared.mirror ) {\n\t\t\t\t\treturn; // already dragging\n\t\t\t\t}\n\n\t\t\t\tvar handle = item;\n\t\t\t\twhile ( getParent( item ) && !isContainer( getParent( item ) ) ) {\n\t\t\t\t\t// break loop if user tries to drag item which is considered invalid handle\n\t\t\t\t\tif ( o.invalid( item, handle ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\titem = getParent( item ); // drag target should be immediate child of container\n\t\t\t\t\tif ( !item ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar source = getParent( item );\n\t\t\t\tif ( !source ||\n\t\t\t\t\to.invalid( item, handle ) || !o.moves( item, source, handle, nextEl( item ) ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\titem: item,\n\t\t\t\t\tsource: source\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction start( context ) {\n\t\t\t\tshared.sourceItem = shared.item = context.item;\n\t\t\t\tshared.source = context.source;\n\t\t\t\tshared.initialSibling = shared.currentSibling = nextEl( context.item );\n\n\t\t\t\tif ( g( o.copy, [ context.item, context.source ] ) ) {\n\t\t\t\t\t// http://api.jquery.com/clone/#clone-withDataAndEvents-deepWithDataAndEvents\n\t\t\t\t\tshared.item = angular.element( context.item ).clone( o.copy === 'events', o.copy === 'events' )[0];\n\t\t\t\t\tshared.copy = o.copy;\n\t\t\t\t\tif ( o.scope ) {\n\t\t\t\t\t\to.scope.$emit( o.eventNames.dragularcloned, shared.item, context.item );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tshared.copy = false;\n\t\t\t\t}\n\n\t\t\t\t// prepare models operations\n\t\t\t\tvar containerIndex = getContainers( o ).indexOf( context.source );\n\t\t\t\tshared.sourceModel = getContainersModel( o )[ containerIndex ];\n\n\t\t\t\tshared.sourceFilteredModel = getContainersFilteredModel( o )[ containerIndex ];\n\t\t\t\tshared.initialIndex = domIndexOf( context.item, context.source );\n\n\t\t\t\tdrake.dragging = true;\n\t\t\t\tif ( o.scope ) {\n\t\t\t\t\to.scope.$emit( o.eventNames.dragulardrag, shared.sourceItem, shared.source );\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfunction manualStart( item ) {\n\t\t\t\tvar context = canStart( item );\n\t\t\t\tif ( context ) {\n\t\t\t\t\tshared.grabbed = context;\n\t\t\t\t\teventualMovements();\n\t\t\t\t\t//start(context);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction renderMirrorImage() {\n\t\t\t\tif ( shared.mirror ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar rect = shared.sourceItem.getBoundingClientRect();\n\t\t\t\tshared.mirror = shared.sourceItem.cloneNode( true );\n\t\t\t\tshared.mirrorWidth = rect.width;\n\t\t\t\tshared.mirrorHeight = rect.height;\n\t\t\t\tshared.mirror.style.width = getRectWidth( rect ) + 'px';\n\t\t\t\tshared.mirror.style.height = getRectHeight( rect ) + 'px';\n\t\t\t\taddClass( shared.mirror, o.classes.mirror );\n\t\t\t\to.mirrorContainer.appendChild( shared.mirror );\n\t\t\t\tregEvent( _docElm, 'on', 'mousemove', drag );\n\t\t\t\taddClass( _doc.body, o.classes.unselectable );\n\t\t\t\tregEvent( shared.mirror, 'on', 'wheel', scrollContainer );\n\t\t\t\tif ( o.scope ) {\n\t\t\t\t\to.scope.$emit( o.eventNames.dragularcloned, shared.mirror, shared.sourceItem );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction end() {\n\t\t\t\tif ( !drake.dragging || !shared.item ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdrop( shared.item, getParent( shared.item ) );\n\t\t\t}\n\n\t\t\tfunction ungrab() {\n\t\t\t\tshared.grabbed = false;\n\t\t\t\teventualMovements( 'remove' );\n\t\t\t\tmovements( 'remove' );\n\t\t\t}\n\n\n\t\t\t// ====================================================================================================================================\n\t\t\t// Drag stage: ------------------------------------------------------------------------------------------------------------------------\n\t\t\t// ====================================================================================================================================\n\n\n\t\t\tfunction drag( e ) { // watch performance!! - function is running each mousemove!\n\t\t\t\tif ( !shared.mirror ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( e.originalEvent ) {\n\t\t\t\t\te = e.originalEvent; // jQuery environment\n\t\t\t\t}\n\n\t\t\t\t// update coordinates\n\t\t\t\tshared.clientX = getCoord( 'clientX', e );\n\t\t\t\tshared.clientY = getCoord( 'clientY', e );\n\n\t\t\t\t// count mirror coordinates\n\t\t\t\tvar x = shared.clientX - shared.offsetX,\n\t\t\t\t\ty = shared.clientY - shared.offsetY,\n\t\t\t\t\tpageX,\n\t\t\t\t\tpageY,\n\t\t\t\t\toffsetBox;\n\n\t\t\t\t// fill extra properties if boundingBox is used\n\t\t\t\tif ( o.boundingBox ) {\n\t\t\t\t\tpageX = getCoord( 'pageX', e );\n\t\t\t\t\tpageY = getCoord( 'pageY', e );\n\t\t\t\t\toffsetBox = getOffset( o.boundingBox );\n\t\t\t\t}\n\n\t\t\t\tif ( !o.lockY ) {\n\t\t\t\t\tif ( !o.boundingBox || (pageX > offsetBox.left + shared.offsetX && pageX < offsetBox.right + shared.offsetXr) ) {\n\t\t\t\t\t\tshared.mirror.style.left = x + 'px';\n\t\t\t\t\t} else if ( o.boundingBox ) { // check again in case user scrolled the view\n\t\t\t\t\t\tif ( pageX < offsetBox.left + shared.offsetX ) {\n\t\t\t\t\t\t\tshared.mirror.style.left = shared.clientX - (pageX - offsetBox.left) + 'px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshared.mirror.style.left = shared.clientX - shared.mirrorWidth - (pageX - offsetBox.right) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( !o.lockX ) {\n\t\t\t\t\tif ( !o.boundingBox || (pageY > offsetBox.top + shared.offsetY && pageY < offsetBox.bottom + shared.offsetYb) ) {\n\t\t\t\t\t\tshared.mirror.style.top = y + 'px';\n\t\t\t\t\t} else if ( o.boundingBox ) { // check again in case user scrolled the view\n\t\t\t\t\t\tif ( pageY < offsetBox.top + shared.offsetY ) {\n\t\t\t\t\t\t\tshared.mirror.style.top = shared.clientY - (pageY - offsetBox.top) + 'px';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshared.mirror.style.top = shared.clientY - shared.mirrorHeight - (pageY - offsetBox.bottom) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar elementBehindCursor = getElementBehindPoint( shared.mirror, shared.clientX, shared.clientY ),\n\t\t\t\t\tdropTarget = findDropTarget( elementBehindCursor, shared.clientX, shared.clientY ),\n\t\t\t\t\tchanged = dropTarget !== shared.lastDropTarget;\n\n\t\t\t\tif ( elementBehindCursor !== shared.lastElementBehindCursor ) {\n\t\t\t\t\tfireEvent( elementBehindCursor, shared.dragOverEvents.dragularenter, !!dropTarget );\n\t\t\t\t\tif ( shared.lastElementBehindCursor ) {\n\t\t\t\t\t\tfireEvent( shared.lastElementBehindCursor, shared.dragOverEvents.dragularleave, elementBehindCursor );\n\t\t\t\t\t}\n\t\t\t\t\tshared.lastElementBehindCursor = elementBehindCursor;\n\t\t\t\t}\n\n\t\t\t\tif ( changed ) {\n\t\t\t\t\tif ( shared.lastDropTarget ) {\n\t\t\t\t\t\tmoved( 'out' );\n\t\t\t\t\t}\n\t\t\t\t\tshared.lastDropTarget = dropTarget;\n\t\t\t\t\tmoved( 'over' );\n\t\t\t\t}\n\n\t\t\t\t// do not copy in same container\n\t\t\t\tif ( dropTarget === shared.source && shared.copy && !g( o.copySortSource ) ) {\n\t\t\t\t\tif ( getParent( shared.item ) ) {\n\t\t\t\t\t\tshared.item.parentNode.removeChild( shared.item );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar reference,\n\t\t\t\t\timmediate = getImmediateChild( dropTarget, elementBehindCursor );\n\n\t\t\t\tif ( immediate !== null ) {\n\t\t\t\t\treference = getReference( dropTarget, immediate, shared.clientX, shared.clientY );\n\t\t\t\t} else if ( g( o.revertOnSpill ) === true && !shared.copy ) {\n\t\t\t\t\t// the case that mirror is not over valid target and reverting is on and copy is off\n\t\t\t\t\treference = shared.initialSibling;\n\t\t\t\t\tdropTarget = shared.source;\n\t\t\t\t} else {\n\t\t\t\t\t// the case that mirror is not over valid target and removing is on or copy is on\n\t\t\t\t\tif ( shared.copy && getParent( shared.item ) ) {\n\t\t\t\t\t\t// remove item or copy of item\n\t\t\t\t\t\tshared.item.parentNode.removeChild( shared.item );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( (reference === null && changed) ||\n\t\t\t\t\treference !== shared.item &&\n\t\t\t\t\treference !== nextEl( shared.item ) &&\n\t\t\t\t\treference !== shared.currentSibling ) {\n\t\t\t\t\t// moving item/copy to new container from previous one\n\t\t\t\t\tshared.currentSibling = reference;\n\n\t\t\t\t\tdropTarget.insertBefore( shared.item, reference ); // if reference is null item is inserted at the end\n\n\t\t\t\t\tif ( o.scope ) {\n\t\t\t\t\t\to.scope.$emit( o.eventNames.dragularshadow, shared.item, dropTarget, e );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction moved( type ) {\n\t\t\t\t\tif ( o.scope ) {\n\t\t\t\t\t\tnotify( o.scope );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( shared.targetCtx && shared.targetCtx.o.scope && shared.targetCtx.o.scope !== o.scope ) {\n\t\t\t\t\t\tnotify( shared.targetCtx.o.scope );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( g( o.removeOnSpill ) === true ) {\n\t\t\t\t\t\ttype === 'over' ? spillOver() : spillOut();\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction notify( scope ){\n\t\t\t\t\t\tscope.$emit( o.eventNames[ 'dragular' + type ], shared.item, shared.lastDropTarget, shared.source, e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// find valid drop container\n\t\t\tfunction findDropTarget( elementBehindCursor, clientX, clientY ) {  // watch performance!! - running each move!\n\t\t\t\tvar target = elementBehindCursor,\n\t\t\t\t\ttargetCtx = null;\n\n\t\t\t\twhile ( target && !accepted() ) {\n\t\t\t\t\ttarget = getParent( target );\n\t\t\t\t}\n\n\t\t\t\t// bugfix #148 model not updated on spill\n\t\t\t\t// added target condition to fix #161\n\t\t\t\tif ( target && targetCtx ){\n\t\t\t\t\tshared.targetCtx = targetCtx;\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\n\t\t\t\tfunction accepted() {\n\n\t\t\t\t\tif ( !isContainer( target ) ) { // is not droppable?\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar immediate = getImmediateChild( target, elementBehindCursor ),\n\t\t\t\t\t\treference = getReference( target, immediate, clientX, clientY ),\n\t\t\t\t\t\tinitial = isInitialPlacement( target, reference ),\n\t\t\t\t\t\ti = o.nameSpace.length,\n\t\t\t\t\t\tnameSpace;\n\n\t\t\t\t\twhile ( i-- ) { // for each namespace\n\t\t\t\t\t\tnameSpace = o.nameSpace[ i ];\n\t\t\t\t\t\tif ( shared.containers[ nameSpace ].indexOf( target ) !== -1 ) {\n\t\t\t\t\t\t\ttargetCtx = getTargetCtx( nameSpace );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// shared.target must be actual (used for scroll functionality)\n\t\t\t\t\tshared.target = target;\n\n\t\t\t\t\tif ( initial ) {\n\n\t\t\t\t\t\treturn true; // accepts = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// try to find target in default set of containers\n\t\t\t\t\t\tif ( !targetCtx ) {\n\t\t\t\t\t\t\ttargetCtx = getTargetCtx( 'dragularCommon' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// if found and containersModel is dynamic, retrieve model\n\t\t\t\t\t\tif ( targetCtx && _isFunction( targetCtx.o.containersModel ) ) {\n\t\t\t\t\t\t\t// fix targetCtx.m(odel) for dynamic containersModel\n\t\t\t\t\t\t\ttargetCtx.m = getContainersModel( targetCtx.o )[ getContainers( targetCtx.o ).indexOf( target ) ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( targetCtx && // target container is defined via service or directive\n\t\t\t\t\t\t\ttargetCtx.o.accepts && !targetCtx.o.accepts( shared.item, target, shared.source, reference, shared.sourceModel, shared.initialIndex ) ) {\n\n\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t} else if ( o.isContainer && // target container is recognized via o.isContainer\n\t\t\t\t\t\t\to.isContainerAccepts && !o.isContainerAccepts( shared.item, target, shared.source, reference, shared.sourceModel, shared.initialIndex ) ) {\n\n\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn !o.canBeAccepted || o.canBeAccepted( shared.item, target, shared.source, reference, shared.sourceModel, shared.initialIndex );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfunction getTargetCtx( nameSpace ) {\n\t\t\t\t\treturn shared.containersCtx[ nameSpace ] && shared.containersCtx[ nameSpace ][ shared.containers[ nameSpace ].indexOf( target ) ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction spillOver() {\n\t\t\t\trmClass( shared.item, o.classes.hide );\n\t\t\t}\n\n\t\t\tfunction spillOut() {\n\t\t\t\tif ( drake.dragging ) {\n\t\t\t\t\taddClass( shared.item, o.classes.hide );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// is item currently placed in original container and original position?\n\t\t\tfunction isInitialPlacement( target, s ) { // watch performance - running each move several times!\n\t\t\t\tvar sibling = s !== undefined ? s : (shared.mirror ? shared.currentSibling : nextEl( shared.item ));\n\t\t\t\treturn target === shared.source && sibling === shared.initialSibling;\n\t\t\t}\n\n\t\t\tfunction getImmediateChild( dropTarget, target ) { // watch performance - running each move several times!\n\t\t\t\tvar immediate = target;\n\t\t\t\twhile ( immediate !== dropTarget && getParent( immediate ) !== dropTarget ) {\n\t\t\t\t\timmediate = getParent( immediate );\n\t\t\t\t}\n\t\t\t\tif ( immediate === _docElm ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn immediate;\n\t\t\t}\n\n\t\t\tfunction getReference( dropTarget, target, x, y ) { // watch performance - running each move several times!\n\t\t\t\tvar horizontal = o.direction === 'horizontal';\n\t\t\t\treturn target !== dropTarget ? inside() : outside();\n\n\t\t\t\tfunction outside() { // slower, but able to figure out any position\n\t\t\t\t\tvar len = dropTarget.children.length,\n\t\t\t\t\t\ti, el, rect;\n\t\t\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\t\t\tel = dropTarget.children[ i ];\n\t\t\t\t\t\trect = el.getBoundingClientRect();\n\t\t\t\t\t\tif ( horizontal && rect.left > x ) {\n\t\t\t\t\t\t\treturn el;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !horizontal && rect.top > y ) {\n\t\t\t\t\t\t\treturn el;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tfunction inside() { // faster, but only available if dropped inside a child element\n\t\t\t\t\tvar rect = target.getBoundingClientRect();\n\t\t\t\t\tif ( horizontal ) {\n\t\t\t\t\t\treturn resolve( x > rect.left + getRectWidth( rect ) / 2 );\n\t\t\t\t\t}\n\t\t\t\t\treturn resolve( y > rect.top + getRectHeight( rect ) / 2 );\n\t\t\t\t}\n\n\t\t\t\tfunction resolve( after ) {\n\t\t\t\t\treturn after ? nextEl( target ) : target;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction getElementBehindPoint( point, x, y ) { // watch performance!! - function is running each mousemove!\n\t\t\t\tvar p = point || {},\n\t\t\t\t\tstate = p.className,\n\t\t\t\t\tel;\n\t\t\t\tp.className += ' ' + o.classes.hide;\n\t\t\t\tel = _doc.elementFromPoint( x, y );\n\t\t\t\tp.className = state;\n\t\t\t\treturn el;\n\t\t\t}\n\n\t\t\tfunction isContainer( el ) {\n\n\t\t\t\tif ( !el ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t      if ( getContainers( o ).indexOf( el ) > -1) {\n\t        return true;\n\t      }\n\n\t\t\t\tvar i = o.nameSpace.length;\n\t\t\t\twhile ( i-- ) {\n\n\t\t\t\t\tif ( shared.containers[ o.nameSpace[ i ] ].indexOf( el ) !== -1 ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( o.isContainer( el ) ) {\n\n\t\t\t\t\tshared.tempModel = o.isContainerModel( el );\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\n\t\t\t\t\tshared.tempModel = null;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfunction getContainers( opt ) {\n\n\t\t\t\treturn _getContainers( 'containers', opt );\n\t\t\t}\n\n\t\t\tfunction getContainersModel( opt ) {\n\n\t\t\t\treturn _getContainers( 'containersModel', opt, true );\n\t\t\t}\n\n\t\t\tfunction getContainersFilteredModel( opt ) {\n\n\t\t\t\treturn _getContainers( 'containersFilteredModel', opt, true );\n\t\t\t}\n\n\t\t\tfunction _getContainers( containersType, opt, to2d ) {\n\n\t\t\t\treturn _isFunction( opt[ containersType ] ) ? sanitizeContainers(\n\t\t\t\t\topt[ containersType ](\n\t\t\t\t\t\t(opt === o ? drake : null),\n\t\t\t\t\t\tshared\n\t\t\t\t\t),\n\t\t\t\t\tto2d,\n\t\t\t\t\topt.scope\n\t\t\t\t) : opt[ containersType ];\n\t\t\t}\n\n\t\t\tfunction cancel( revert ) {\n\t\t\t\tif ( !drake.dragging ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar reverts = arguments.length > 0 ? revert : g( o.revertOnSpill ),\n\t\t\t\t\tparent = getParent( shared.item );\n\n\t\t\t\tvar initial = isInitialPlacement( parent );\n\t\t\t\tif ( !initial && !shared.copy && reverts ) {\n\t\t\t\t\tshared.source.insertBefore( shared.item, shared.initialSibling );\n\t\t\t\t}\n\t\t\t\tif ( shared.sourceModel && !shared.copy && !reverts ) {\n\t\t\t\t\tdrop( shared.item, parent );\n\t\t\t\t} else if ( o.scope ) {\n\t\t\t\t\tif ( initial || reverts ) {\n\t\t\t\t\t\to.scope.$emit( o.eventNames.dragularcancel, shared.item, shared.source, shared.sourceModel, shared.initialIndex );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( !shared.sourceModel || shared.copy || reverts || initial ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// ====================================================================================================================================\n\t\t\t// Release stage: ------------------------------------------------------------------------------------------------------------------------\n\t\t\t// ====================================================================================================================================\n\n\n\t\t\tfunction release( e ) {\n\n\t\t\t\tungrab();\n\t\t\t\tif ( !drake.dragging ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( e.originalEvent ) {\n\t\t\t\t\te = e.originalEvent; // jQuery enviroment\n\t\t\t\t}\n\n\t\t\t\tshared.clientX = getCoord( 'clientX', e );\n\t\t\t\tshared.clientY = getCoord( 'clientY', e );\n\n\t\t\t\tvar elementBehindCursor = getElementBehindPoint( shared.mirror, shared.clientX, shared.clientY ),\n\t\t\t\t\tdropTarget = findDropTarget( elementBehindCursor, shared.clientX, shared.clientY );\n\n\t\t\t\tif ( dropTarget && ((shared.copy && g( o.copySortSource )) || (!shared.copy || dropTarget !== shared.source)) ) {\n\t\t\t\t\t// found valid target and (is not copy case or target is not initial container)\n\t\t\t\t\tdrop( shared.item, dropTarget );\n\t\t\t\t} else if ( g( o.removeOnSpill ) ) {\n\t\t\t\t\tremove();\n\t\t\t\t} else {\n\t\t\t\t\tcancel();\n\t\t\t\t}\n\n\t\t\t\t// after release there is no container hovered\n\t\t\t\tshared.target = null;\n\n\t\t\t\tif ( shared.lastElementBehindCursor ) {\n\t\t\t\t\tfireEvent( shared.lastElementBehindCursor, shared.dragOverEvents.dragularrelease, elementBehindCursor );\n\t\t\t\t}\n\n\t\t\t\tif ( o.scope ) {\n\t\t\t\t\to.scope.$emit( o.eventNames.dragularrelease, shared.item, shared.source, e );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction drop( item, target ) {\n\t\t\t\tif ( !item ) { // https://github.com/luckylooke/dragular/issues/102\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar sourceItem = shared.sourceItem,\n\t\t\t\t\tcurrentSibling = shared.currentSibling,\n\t\t\t\t\tdropIndex = domIndexOf( item, target );\n\n\t\t\t\tif ( shared.copy && target === shared.source && getParent( item ) && g( o.copySortSource ) ) {\n\t\t\t\t\titem.parentNode.removeChild( shared.sourceItem );\n\t\t\t\t}\n\n\t\t\t\tif ( shared.sourceModel && !isInitialPlacement( target ) ) {\n\t\t\t\t\tif ( shared.targetCtx && shared.targetCtx.fm ) { // target has filtered model\n\t\t\t\t\t\t// convert index from index-in-filteredModel to index-in-model\n\t\t\t\t\t\tdropIndex = shared.targetCtx.m.indexOf( shared.targetCtx.fm[ dropIndex ] );\n\t\t\t\t\t}\n\t\t\t\t\tif ( shared.sourceFilteredModel ) { // source has filtered model\n\t\t\t\t\t\t// convert index from index-in-filteredModel to index-in-model\n\t\t\t\t\t\tshared.initialIndex = shared.sourceModel.indexOf( shared.sourceFilteredModel[ shared.initialIndex ] );\n\t\t\t\t\t}\n\t\t\t\t\t$rootScope.$applyAsync( function applyDrop() {\n\t\t\t\t\t\tif ( !shared.sourceModel ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( target === shared.source ) {\n\t\t\t\t\t\t\tshared.sourceModel.splice( dropIndex, 0, shared.sourceModel.splice( shared.initialIndex, 1 )[ 0 ] );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshared.dropElmModel = shared.copy && !o.dontCopyModel ? angular.copy( shared.sourceModel[ shared.initialIndex ] ) : shared.sourceModel[ shared.initialIndex ];\n\n\t\t\t\t\t\t\tif ( !shared.tempModel ) {\n\t\t\t\t\t\t\t\tshared.targetModel = ( shared.targetCtx && shared.targetCtx.m ) || shared.sourceModel;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshared.targetModel = shared.tempModel;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\titem.parentNode.removeChild( item ); // element must be removed for ngRepeat to apply correctly\n\n\t\t\t\t\t\t\tif ( !shared.copy ) {\n\t\t\t\t\t\t\t\tshared.sourceModel.splice( shared.initialIndex, 1 );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( shared.targetModel ) {\n\t\t\t\t\t\t\t\tshared.targetModel.splice( dropIndex, 0, shared.dropElmModel );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// removing element, as protection against duplicates, angular ng-repeat will create new item according to model\n\t\t\t\t\t\tif ( getParent( item ) ) {\n\t\t\t\t\t\t\titem.parentNode.removeChild( item );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tafterDrop();\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tafterDrop();\n\t\t\t\t}\n\n\t\t\t\tfunction afterDrop() {\n\n\t\t\t\t\t// in nested containers case, new containers doesnt have registered mousedown\n\t\t\t\t\tgetContainers( o ).forEach( function readdMouseDown( container ) {\n\t\t\t\t\t\tregEvent( container, 'off', 'mousedown', grab );\n\t\t\t\t\t\tregEvent( container, 'on', 'mousedown', grab );\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( o.compileItemOnDrop ) {\n\t\t\t\t\t\tvar scope = angular.element( target ).scope ? angular.element( target ).scope() : o.scope;\n\t\t\t\t\t\tif ( scope ) {\n\t\t\t\t\t\t\tscope.$applyAsync( function () {\n\t\t\t\t\t\t\t\tvar content = $compile( shared.copy ? sourceItem.cloneNode( true ) : sourceItem )( scope );\n\t\t\t\t\t\t\t\tif ( item.parentNode === target ) {\n\t\t\t\t\t\t\t\t\ttarget.removeChild( item );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttarget.insertBefore( content[ 0 ], currentSibling );\n\t\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( o.scope ) {\n\t\t\t\t\t\tnotify( o.scope );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( shared.targetCtx && shared.targetCtx.o.scope && shared.targetCtx.o.scope !== o.scope ) {\n\t\t\t\t\t\tnotify( shared.targetCtx.o.scope );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !o.compileItemOnDrop ) {\n\t\t\t\t\t\tcleanup();\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction notify( scope ){\n\t\t\t\t\t\tif ( isInitialPlacement( target ) ) {\n\t\t\t\t\t\t\tscope.$emit( o.eventNames.dragularcancel, item, shared.source, shared.sourceModel, shared.initialIndex );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscope.$emit( o.eventNames.dragulardrop, item, target, shared.source, shared.sourceModel, shared.initialIndex, shared.targetModel, dropIndex );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction remove() {\n\t\t\t\tif ( !drake.dragging ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar parent = getParent( shared.item );\n\n\t\t\t\tif ( parent ) {\n\t\t\t\t\tparent.removeChild( shared.item );\n\t\t\t\t}\n\n\t\t\t\tif ( shared.sourceModel ) {\n\t\t\t\t\t$rootScope.$applyAsync( function removeModel() {\n\t\t\t\t\t\tshared.sourceModel.splice( shared.initialIndex, 1 );\n\t\t\t\t\t\tcleanup();\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tif ( o.scope ) {\n\t\t\t\t\to.scope.$emit( shared.copy ? o.eventNames.dragularcancel : o.eventNames.dragularremove, shared.item, parent, shared.sourceModel, shared.initialIndex );\n\t\t\t\t}\n\t\t\t\tif ( !shared.sourceModel ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction cleanup() {\n\t\t\t\tungrab();\n\t\t\t\tremoveMirrorImage();\n\n\t\t\t\tif ( shared.item ) {\n\t\t\t\t\trmClass( shared.item, o.classes.transit );\n\t\t\t\t}\n\n\t\t\t\tdrake.dragging = false;\n\n\t\t\t\tif ( g( o.removeOnSpill ) === true ) {\n\t\t\t\t\tspillOut();\n\t\t\t\t}\n\n\t\t\t\tif ( o.scope ) {\n\t\t\t\t\tif ( shared.lastDropTarget ) {\n\t\t\t\t\t\to.scope.$emit( o.eventNames.dragularout, shared.item, shared.lastDropTarget, shared.source );\n\t\t\t\t\t}\n\t\t\t\t\to.scope.$emit( o.eventNames.dragulardragend, shared.item );\n\t\t\t\t}\n\n\t\t\t\tshared.source = shared.item = shared.sourceItem = shared.initialSibling = shared.currentSibling = shared.sourceModel = null;\n\t\t\t\tshared.initialIndex = shared.currentIndex = shared.lastDropTarget = shared.tempModel = shared.targetModel = null;\n\t\t\t\tshared.dropElmModel = shared.targetCtx = shared.copy = shared.moveX = shared.moveY = null;\n\t\t\t}\n\n\t\t\tfunction destroy() {\n\n\t\t\t\tregisterEvents( true );\n\t\t\t\tremoveContainers( o.containers );\n\t\t\t\trelease( {} );\n\t\t\t}\n\n\t\t\tfunction addContainers( containers, containersModel, containersFilteredModel ) {\n\n\t      if (!containers) {\n\t        return;\n\t      }\n\n\t      containersModel = containersModel || getContainersModel( o ) || {};\n\t      containersFilteredModel = containersFilteredModel || getContainersFilteredModel( o ) || {};\n\t      containers = _isArray( containers ) ? containers : makeArray( containers );\n\t      containers.forEach( function forEachContainer( container ) {\n\n\t        angular.forEach( o.nameSpace, function forEachNs( nameSpace ) {\n\t          if (shared.containers[ nameSpace ].indexOf( container ) > -1) {\n\t            return;\n\t          }\n\n\t          var newIndex = shared.containers[ nameSpace ].push( container ) - 1;\n\t          shared.containersCtx[ nameSpace ].push({\n\t            o: o,\n\t            m: containersModel[ newIndex ], // can be undefined\n\t            fm: containersFilteredModel[ newIndex ] // can be undefined\n\t          });\n\n\t          regEvent( container, 'off', 'mousedown', grab );\n\t\t\t\t\t\tregEvent( container, 'on', 'mousedown', grab );\n\t        } );\n\t      } );\n\t    }\n\n\t\t\tfunction removeContainers( containers ) {\n\n\t\t\t\t$rootScope.$applyAsync( function applyDestroyed() {\n\n\t\t\t\t\tcontainers = _isArray( containers ) ? containers : makeArray( containers );\n\t\t\t\t\tcontainers.forEach( function forEachContainer( container ) {\n\n\t\t\t\t\t\tangular.forEach( o.nameSpace, function forEachNs( nameSpace ) {\n\n\t\t\t\t\t\t\tvar index;\n\t\t\t\t\t\t\tindex = shared.containers[ nameSpace ].indexOf( container );\n\t\t\t\t\t\t\tshared.containers[ nameSpace ].splice( index, 1 );\n\t\t\t\t\t\t\tshared.containersCtx[ nameSpace ].splice( index, 1 );\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tfunction scrollContainer( e ) {\n\t\t\t\tif ( shared.target ) {\n\t\t\t\t\tif ( e.originalEvent ) {\n\t\t\t\t\t\te = e.originalEvent; // jQuery enviroment\n\t\t\t\t\t}\n\t\t\t\t\tvar before = shared.target.scrollTop;\n\t\t\t\t\tshared.target.scrollTop += e.deltaY;\n\t\t\t\t\t// block scroll of the document when container can be scrolled\n\t\t\t\t\tif ( before !== shared.target.scrollTop ) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction removeMirrorImage() {\n\t\t\t\tif ( shared.mirror ) {\n\t\t\t\t\trmClass( _doc.body, o.classes.unselectable );\n\t\t\t\t\tregEvent( _docElm, 'off', 'mousemove', drag );\n\t\t\t\t\tregEvent( shared.mirror, 'off', 'wheel', scrollContainer );\n\t\t\t\t\tif ( getParent( shared.mirror ) ) {\n\t\t\t\t\t\tshared.mirror.parentNode.removeChild( shared.mirror );\n\t\t\t\t\t}\n\t\t\t\t\tshared.mirror = null;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// ====================================================================================================================================\n\t\t\t// Other fns: -------------------------------------------------------------------------------------------------------------------------\n\t\t\t// ====================================================================================================================================\n\n\n\t\t\tfunction depSanitize( containersModel ) {\n\t\t\t\tconsole.warn( 'Deprecated method drake.sanitizeContainersModel! Will be removed in next major release! Please use sanitizeContainers instead.' );\n\t\t\t\tsanitizeContainers( containersModel, true, o.scope );\n\t\t\t}\n\n\t\t} // end of service\n\n\t\t/****************************************************************************************************************************/\n\t\t/****************************************************************************************************************************/\n\t\t/****************************************************************************************************************************/\n\n\t\t// HELPERS FUNCTIONS:\n\n\t\tfunction sanitizeContainers( containers, to2d, scope ) {\n\n\t\t\tif ( _isFunction( containers ) ) {\n\n\t\t\t\treturn containers;\n\t\t\t}\n\t\t\telse if ( _isArray( containers ) ) {\n\n\t\t\t\tif ( to2d ) {\n\t\t\t\t\t//                  |-------- is 2D array? -----------|\n\t\t\t\t\treturn _isArray( containers[ 0 ] ) ? containers : [ containers ];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn containers;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( typeof containers === 'string' && scope ) {\n\n\t\t\t\tvar evaluated = scope.$eval( containers );\n\n\t\t\t\tif ( _isFunction( evaluated ) ) {\n\t\t\t\t\treturn evaluated;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn function () {\n\t\t\t\t\t\treturn scope.$eval( containers );\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( containers ) {\n\n\t\t\t\treturn makeArray( containers );\n\t\t\t}\n\n\t\t\treturn [];\n\t\t}\n\n\t\tfunction regEvent( el, op, type, fn ) {\n\t\t\tvar touch = {\n\t\t\t\t\tmouseup: 'touchend',\n\t\t\t\t\tmousedown: 'touchstart',\n\t\t\t\t\tmousemove: 'touchmove'\n\t\t\t\t},\n\t\t\t\tpointers = {\n\t\t\t\t\tmouseup: 'pointerup',\n\t\t\t\t\tmousedown: 'pointerdown',\n\t\t\t\t\tmousemove: 'pointermove'\n\t\t\t\t},\n\t\t\t\tmicrosoft = {\n\t\t\t\t\tmouseup: 'MSPointerUp',\n\t\t\t\t\tmousedown: 'MSPointerDown',\n\t\t\t\t\tmousemove: 'MSPointerMove'\n\t\t\t\t},\n\t\t\t\t$el = angular.element( el );\n\n\t\t\tif ( el.addEventListener ) {\n\n\t\t\t\tvar opConvert = { on: 'addEventListener', off: 'removeEventListener' };\n\t\t\t\tel[ opConvert[ op ] ]( type, fn, { passive: false } );\n\t\t\t\tel[ opConvert[ op ] ]( touch[ type ], fn, { passive: false } );\n\n\t\t\t} else {\n\n\t\t\t\tif ( typeof navigator !== 'undefined' && navigator.pointerEnabled && pointers[ type ] ) {\n\t\t\t\t\t$el[ op ]( pointers[ type ], fn );\n\t\t\t\t} else if ( typeof navigator !== 'undefined' && navigator.msPointerEnabled && microsoft[ type ] ) {\n\t\t\t\t\t$el[ op ]( microsoft[ type ], fn );\n\t\t\t\t} else if ( touch[ type ] ) {\n\t\t\t\t\t$el[ op ]( touch[ type ], fn );\n\t\t\t\t}\n\t\t\t\t$el[ op ]( type, fn );\n\n\t\t\t}\n\t\t}\n\n\t\tfunction never() {\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction always() {\n\t\t\treturn true;\n\t\t}\n\n\t\t// make array from array-like objects or from single element (based on bevacqua/atoa)\n\t\tfunction makeArray( all, startIndex ) {\n\t\t\tif ( _isArray( all ) ) {\n\t\t\t\treturn all;\n\t\t\t}\n\t\t\tif ( all.length ) { // is array-like\n\t\t\t\treturn Array.prototype.slice.call( all, startIndex ); // convert to vanilla js array\n\t\t\t} else { // is one element\n\t\t\t\treturn [ all ];\n\t\t\t}\n\t\t}\n\n\t\tfunction whichMouseButton( e ) {\n\t\t\tif ( e.touches ) {\n\t\t\t\treturn e.touches.length;\n\t\t\t}\n\t\t\tif ( e.originalEvent && e.originalEvent.touches ) {\n\t\t\t\treturn e.originalEvent.touches.length;\n\t\t\t}\n\t\t\tif ( e.which !== void 0 && e.which !== 0 ) {\n\t\t\t\treturn e.which;\n\t\t\t} // github.com/bevacqua/dragula/issues/261\n\t\t\tif ( e.buttons !== undefined ) {\n\t\t\t\treturn e.buttons;\n\t\t\t}\n\t\t\tvar button = e.button;\n\t\t\tif ( button !== undefined ) { // see github.com/jquery/jquery/blob/99e8ff1baa7ae341e94bb89c3e84570c7c3ad9ea/src/event.js#L573-L575\n\t\t\t\treturn button & 1 ? 1 : button & 2 ? 3 : (button & 4 ? 2 : 0);\n\t\t\t}\n\t\t}\n\n\t\tfunction preventGrabbed( e ) {\n\t\t\tif ( e.originalEvent ) {\n\t\t\t\te = e.originalEvent; // jQuery enviroment\n\t\t\t}\n\t\t\tif ( shared.grabbed ) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tfunction getScroll( scrollProp, offsetProp ) {\n\t\t\tif ( typeof window[ offsetProp ] !== 'undefined' ) {\n\t\t\t\treturn window[ offsetProp ];\n\t\t\t}\n\t\t\tif ( _docElm.clientHeight ) {\n\t\t\t\treturn _docElm[ scrollProp ];\n\t\t\t}\n\t\t\treturn _doc.body[ scrollProp ];\n\t\t}\n\n\t\tfunction getOffset( el ) { // watch performance!! - function is running each mousemove!\n\t\t\tvar rect = el.getBoundingClientRect(),\n\t\t\t\tscrollTop = getScroll( 'scrollTop', 'pageYOffset' ),\n\t\t\t\tscrollLeft = getScroll( 'scrollLeft', 'pageXOffset' );\n\t\t\treturn {\n\t\t\t\tleft: rect.left + scrollLeft,\n\t\t\t\tright: rect.right + scrollLeft,\n\t\t\t\ttop: rect.top + scrollTop,\n\t\t\t\tbottom: rect.bottom + scrollTop\n\t\t\t};\n\t\t}\n\n\t\tfunction getRectWidth( rect ) {\n\t\t\treturn rect.width || (rect.right - rect.left);\n\t\t}\n\n\t\tfunction getRectHeight( rect ) {\n\t\t\treturn rect.height || (rect.bottom - rect.top);\n\t\t}\n\n\t\tfunction getEmptyArray() {\n\t\t\treturn [];\n\t\t}\n\n\t\tfunction nextEl( el ) {\n\t\t\tif ( !el ) { // https://github.com/luckylooke/dragular/issues/102\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn el.nextElementSibling || manually();\n\n\t\t\tfunction manually() {\n\t\t\t\tvar sibling = el;\n\t\t\t\tdo {\n\t\t\t\t\tsibling = sibling.nextSibling;\n\t\t\t\t} while ( sibling && sibling.nodeType !== 1 );\n\t\t\t\treturn sibling;\n\t\t\t}\n\t\t}\n\n\t\t//Cannot use angular.isElement because we need to check plain dom element, no jQlite wrapped\n\t\tfunction isElement( obj ) {\n\t\t\treturn (\n\t\t\t\ttypeof HTMLElement === 'object' ? obj instanceof HTMLElement : //DOM2\n\t\t\t\t\tobj && typeof obj === 'object' && obj !== null && obj.nodeType === 1 && typeof obj.nodeName === 'string'\n\t\t\t);\n\t\t}\n\n\t\tfunction lookupClass( className ) {\n\t\t\tvar cached = shared.classesCache[ className ];\n\t\t\tif ( cached ) {\n\t\t\t\tcached.lastIndex = 0;\n\t\t\t} else {\n\t\t\t\tshared.classesCache[ className ] = cached = new RegExp( '(?:^|\\\\s)' + className + '(?:\\\\s|$)', 'g' );\n\t\t\t}\n\t\t\treturn cached;\n\t\t}\n\n\t\tfunction addClass( el, className ) {\n\t\t\tvar current = el.className;\n\t\t\tif ( !current.length ) {\n\t\t\t\tel.className = className;\n\t\t\t} else if ( !lookupClass( className ).test( current ) ) {\n\t\t\t\tel.className += ' ' + className;\n\t\t\t}\n\t\t}\n\n\t\tfunction rmClass( el, className ) {\n\t\t\tel.className = el.className.replace( lookupClass( className ), ' ' ).trim();\n\t\t}\n\n\t\tfunction getEventHost( e ) {\n\t\t\t// on touchend event, we have to use `e.changedTouches`\n\t\t\t// see http://stackoverflow.com/questions/7192563/touchend-event-properties\n\t\t\t// see https://github.com/bevacqua/dragula/issues/34\n\t\t\tif ( e.targetTouches && e.targetTouches.length ) {\n\t\t\t\treturn e.targetTouches[ 0 ];\n\t\t\t}\n\t\t\tif ( e.changedTouches && e.changedTouches.length ) {\n\t\t\t\treturn e.changedTouches[ 0 ];\n\t\t\t}\n\t\t\treturn e;\n\t\t}\n\n\t\tfunction getCoord( coord, e ) { // watch performance - running each move several times!\n\t\t\tvar host = getEventHost( e );\n\t\t\tvar missMap = {\n\t\t\t\tpageX: 'clientX', // IE8\n\t\t\t\tpageY: 'clientY' // IE8\n\t\t\t};\n\t\t\tif ( coord in missMap && !(coord in host) && missMap[ coord ] in host ) {\n\t\t\t\tcoord = missMap[ coord ];\n\t\t\t}\n\n\t\t\t// Adding support for touch events, as they are not functional in the original\n\t\t\tif ( !host.type || host.type.indexOf( 'touch' ) < 0 ) {\n\t\t\t\treturn host[ coord ];\n\t\t\t} else {\n\t\t\t\tif ( host.type.indexOf( 'end' ) === -1 ) {\n\t\t\t\t\t// No clientX or clientY in a touch event\n\t\t\t\t\treturn host.originalEvent.touches[ 0 ][ coord.replace( 'client', 'page' ) ];\n\t\t\t\t}\n\t\t\t\t// Nothing should happen for touchend\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfunction getParent( el ) { // watch performance!! - function is running each mousemove!\n\t\t\treturn el.parentNode === document ? null : el.parentNode;\n\t\t}\n\n\t\tfunction isInput( el ) {\n\t\t\treturn el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT' || isEditable( el );\n\t\t}\n\n\t\tfunction isEditable( el ) {\n\t\t\tif ( !el ) {\n\t\t\t\treturn false;\n\t\t\t} // no parents were editable\n\t\t\tif ( el.contentEditable === 'false' ) {\n\t\t\t\treturn false;\n\t\t\t} // stop the lookup\n\t\t\tif ( el.contentEditable === 'true' ) {\n\t\t\t\treturn true;\n\t\t\t} // found a contentEditable element in the chain\n\t\t\treturn isEditable( getParent( el ) ); // contentEditable is set to 'inherit'\n\t\t}\n\n\t\tfunction domIndexOf( child, parent ) {\n\t\t\treturn Array.prototype.indexOf.call( angular.element( parent ).children(), child );\n\t\t}\n\n\t\tfunction fireEvent( target, e, extra ) { // watch performance!! - function is running each mousemove!\n\t\t\tif ( !target ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tshared.extra = extra;\n\t\t\tif ( target.dispatchEvent ) {\n\t\t\t\ttarget.dispatchEvent( e );\n\t\t\t} else {\n\t\t\t\ttarget.fireEvent( 'on' + e.eventType, e );\n\t\t\t}\n\t\t}\n\n\t\tfunction getBool( prop, args, context ) {\n\t\t\tif ( _isFunction( prop ) ) {\n\t\t\t\treturn !!prop.apply( context || this, args || shared );\n\t\t\t} else {\n\t\t\t\treturn !!prop;\n\t\t\t}\n\t\t}\n\n\t};\n\n\tdragularService.$inject = [ '$rootScope', '$compile' ];\n\n\tmodule.exports = dragularService;\n\n\n/***/ })\n/******/ ])\n});\n;"]}